---
// src/components/TestimonialWithSchema.astro
// Renders testimonial with embedded Review schema for rich snippets

export interface Props {
  quote: string;
  author: string;
  location?: string;
  rating?: number; // 1-5 stars
}

const { quote, author, location = "", rating = 5 } = Astro.props;

// Generate Review schema for this testimonial
const reviewSchema = {
  "@context": "https://schema.org",
  "@type": "Review",
  "reviewRating": {
    "@type": "Rating",
    "ratingValue": rating,
    "bestRating": 5,
    "worstRating": 1
  },
  "author": {
    "@type": "Person",
    "name": author
  },
  "reviewBody": quote,
  "datePublished": new Date().toISOString().split('T')[0]
};
---

<div style="background: var(--cream); padding: 1.5rem; border-left: 4px solid var(--brown); margin-bottom: 1.5rem; border-radius: 4px;">
  <!-- Review Schema Markup -->
  <script type="application/ld+json" set:html={JSON.stringify(reviewSchema)} />

  <!-- Star rating display -->
  <div style="margin-bottom: 0.75rem; color: #f39c12; font-size: 1.1rem;">
    {'★'.repeat(rating)}{'☆'.repeat(5 - rating)}
  </div>

  <p><em>"{quote}"</em></p>
  <p><strong>{author}</strong> {location && `- ${location}`}</p>
</div>
